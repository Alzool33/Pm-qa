<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نظام إدارة المشاريع - قسم الإنشاءات</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            direction: rtl;
        }

        /* صفحة تسجيل الدخول */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .login-card {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 400px;
            text-align: center;
        }

        .login-logo {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
        }

        .login-title {
            font-size: 24px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }

        .login-subtitle {
            color: #666;
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 20px;
            text-align: right;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 500;
        }

        .form-input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .login-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .login-btn:hover {
            transform: translateY(-2px);
        }

        .footer-text {
            margin-top: 30px;
            color: #666;
            font-size: 14px;
        }

        /* الواجهة الرئيسية */
        .main-container {
            display: none;
            min-height: 100vh;
        }

        .sidebar {
            width: 280px;
            background: white;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            z-index: 1000;
        }

        .sidebar-header {
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-align: center;
        }

        .sidebar-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .sidebar-subtitle {
            font-size: 14px;
            opacity: 0.9;
        }

        .sidebar-menu {
            padding: 20px 0;
        }

        .menu-item {
            display: flex;
            align-items: center;
            padding: 15px 25px;
            color: #333;
            text-decoration: none;
            transition: all 0.3s;
            border-right: 3px solid transparent;
        }

        .menu-item:hover, .menu-item.active {
            background: #f8f9fa;
            border-right-color: #667eea;
            color: #667eea;
        }

        .menu-item i {
            width: 20px;
            margin-left: 15px;
            font-size: 16px;
        }

        .content {
            margin-right: 280px;
            padding: 20px;
            min-height: 100vh;
        }

        .top-bar {
            background: white;
            padding: 15px 25px;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .search-box {
            flex: 1;
            max-width: 400px;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 10px 40px 10px 15px;
            border: 2px solid #e1e5e9;
            border-radius: 25px;
            font-size: 14px;
        }

        .search-icon {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #666;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logout-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
        }

        /* بطاقات الإحصائيات */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100%;
            height: 4px;
        }

        .stat-card.total::before { background: #3498db; }
        .stat-card.active::before { background: #f39c12; }
        .stat-card.completed::before { background: #27ae60; }
        .stat-card.warranty::before { background: #e74c3c; }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
        }

        .stat-card.total .stat-icon { background: #3498db; }
        .stat-card.active .stat-icon { background: #f39c12; }
        .stat-card.completed .stat-icon { background: #27ae60; }
        .stat-card.warranty .stat-icon { background: #e74c3c; }

        .stat-number {
            font-size: 36px;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #666;
            font-size: 14px;
        }

        .stat-sublabel {
            color: #999;
            font-size: 12px;
            margin-top: 5px;
        }

        /* قائمة المشاريع */
        .projects-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f8f9fa;
        }

        .section-title {
            font-size: 20px;
            font-weight: bold;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .project-item {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            border-right: 4px solid #667eea;
            cursor: pointer;
            transition: all 0.3s;
        }

        .project-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .project-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .project-title {
            font-weight: bold;
            color: #333;
            font-size: 16px;
            margin-bottom: 5px;
        }

        .project-number {
            color: #666;
            font-size: 14px;
        }

        .project-progress {
            text-align: left;
        }

        .progress-text {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
        }

        .progress-bar {
            width: 100px;
            height: 8px;
            background: #e1e5e9;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #27ae60, #2ecc71);
            border-radius: 4px;
            transition: width 0.3s;
        }

        .project-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #e1e5e9;
        }

        .detail-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            color: #666;
        }

        .detail-item i {
            color: #667eea;
            width: 16px;
        }

        .detail-value {
            color: #333;
            font-weight: 500;
        }

        /* تفاصيل المشروع المنبثقة */
        .project-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            overflow-y: auto;
        }

        .modal-content {
            background: white;
            margin: 20px auto;
            border-radius: 15px;
            max-width: 900px;
            width: 90%;
            position: relative;
        }

        .modal-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 25px;
            border-radius: 15px 15px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 20px;
            font-weight: bold;
        }

        .close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            padding: 5px;
        }

        .modal-body {
            padding: 25px;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
        }

        .info-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
        }

        .info-section-title {
            font-size: 16px;
            font-weight: bold;
            color: #333;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .info-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #e1e5e9;
        }

        .info-item:last-child {
            border-bottom: none;
        }

        .info-label {
            color: #666;
            font-size: 14px;
        }

        .info-value {
            color: #333;
            font-weight: 500;
            text-align: left;
        }

        .notes-section {
            grid-column: 1 / -1;
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 10px;
            padding: 20px;
        }

        .notes-title {
            color: #856404;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .notes-text {
            color: #856404;
            line-height: 1.6;
        }

        /* التصميم المتجاوب */
        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                transform: translateX(-100%);
                transition: transform 0.3s;
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .content {
                margin-right: 0;
            }

            .top-bar {
                flex-direction: column;
                gap: 15px;
            }

            .search-box {
                max-width: none;
            }

            .stats-grid {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }

            .project-details {
                grid-template-columns: 1fr;
            }

            .info-grid {
                grid-template-columns: 1fr;
            }
        }

        .mobile-menu-btn {
            display: none;
            background: #667eea;
            color: white;
            border: none;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
        }

        @media (max-width: 768px) {
            .mobile-menu-btn {
                display: block;
            }
        }

        /* أنماط إضافية للتحسين */
        .highlight {
            background: #fff3cd !important;
            border-color: #ffeaa7 !important;
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .no-results {
            text-align: center;
            padding: 40px;
            color: #666;
            font-style: italic;
        }
    </style>
</head>
<body>
    <!-- صفحة تسجيل الدخول -->
    <div id="loginPage" class="login-container">
        <div class="login-card">
            <div class="login-logo">
                <i class="fas fa-building"></i>
            </div>
            <h1 class="login-title">نظام إدارة المشاريع</h1>
            <p class="login-subtitle">قسم الإنشاءات</p>
            
            <form id="loginForm">
                <div class="form-group">
                    <label class="form-label">البريد الإلكتروني *</label>
                    <input type="email" class="form-input" id="email" value="alzooool33@gmail.com" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">كلمة المرور *</label>
                    <input type="password" class="form-input" id="password" value="123456" required>
                </div>
                
                <button type="submit" class="login-btn">تسجيل الدخول</button>
            </form>
            
            <p class="footer-text">
                للدعم الفني، تواصل مع الإدارة<br>
                جميع الحقوق محفوظة © 2024 - محمد عبدالرحيم نور
            </p>
        </div>
    </div>

    <!-- الواجهة الرئيسية -->
    <div id="mainApp" class="main-container">
        <!-- الشريط الجانبي -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-title">لوحة التحكم</div>
                <div class="sidebar-subtitle">نظام إدارة المشاريع - قسم الإنشاءات</div>
            </div>
            
            <nav class="sidebar-menu">
                <a href="#" class="menu-item active" data-page="dashboard">
                    <i class="fas fa-tachometer-alt"></i>
                    لوحة التحكم
                </a>
                <a href="#" class="menu-item" data-page="projects">
                    <i class="fas fa-building"></i>
                    المشاريع
                </a>
                <a href="#" class="menu-item" data-page="completed">
                    <i class="fas fa-check-circle"></i>
                    المشاريع المكتملة
                </a>
                <a href="#" class="menu-item" data-page="warranty">
                    <i class="fas fa-shield-alt"></i>
                    المشاريع تحت الضمان
                </a>
                <a href="#" class="menu-item" data-page="buildings">
                    <i class="fas fa-city"></i>
                    المباني
                </a>
                <a href="#" class="menu-item" data-page="maintenance-requests">
                    <i class="fas fa-tools"></i>
                    طلبات الصيانة
                </a>
                <a href="#" class="menu-item" data-page="maintenance-tasks">
                    <i class="fas fa-clipboard-list"></i>
                    مهام الصيانة
                </a>
                <a href="#" class="menu-item" data-page="reports">
                    <i class="fas fa-chart-bar"></i>
                    التقارير
                </a>
                <a href="#" class="menu-item" data-page="users">
                    <i class="fas fa-users"></i>
                    المستخدمين
                </a>
                <a href="#" class="menu-item" data-page="settings">
                    <i class="fas fa-cog"></i>
                    الإعدادات
                </a>
            </nav>
        </div>

        <!-- المحتوى الرئيسي -->
        <div class="content">
            <!-- الشريط العلوي -->
            <div class="top-bar">
                <button class="mobile-menu-btn" onclick="toggleSidebar()">
                    <i class="fas fa-bars"></i>
                </button>
                
                <div class="search-box">
                    <input type="text" class="search-input" id="searchInput" placeholder="البحث في المشاريع...">
                    <i class="fas fa-search search-icon"></i>
                </div>
                
                <div class="user-info">
                    <span>مرحباً، محمد عبدالرحيم نور</span>
                    <button class="logout-btn" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i> تسجيل الخروج
                    </button>
                </div>
            </div>

            <!-- محتوى الصفحات -->
            <div id="pageContent">
                <!-- لوحة التحكم -->
                <div id="dashboardPage" class="page-content">
                    <!-- بطاقات الإحصائيات -->
                    <div class="stats-grid">
                        <div class="stat-card total">
                            <div class="stat-icon">
                                <i class="fas fa-building"></i>
                            </div>
                            <div class="stat-number" id="totalProjects">82</div>
                            <div class="stat-label">إجمالي المشاريع</div>
                            <div class="stat-sublabel">0 قيد التنفيذ</div>
                        </div>
                        
                        <div class="stat-card active">
                            <div class="stat-icon">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="stat-number" id="activeProjects">82</div>
                            <div class="stat-label">قيد التخطيط</div>
                            <div class="stat-sublabel">مشاريع جديدة</div>
                        </div>
                        
                        <div class="stat-card completed">
                            <div class="stat-icon">
                                <i class="fas fa-check"></i>
                            </div>
                            <div class="stat-number" id="completedProjects">0</div>
                            <div class="stat-label">مكتملة</div>
                            <div class="stat-sublabel">مشاريع منجزة</div>
                        </div>
                        
                        <div class="stat-card warranty">
                            <div class="stat-icon">
                                <i class="fas fa-shield-alt"></i>
                            </div>
                            <div class="stat-number" id="warrantyProjects">0</div>
                            <div class="stat-label">ضمان ساري</div>
                            <div class="stat-sublabel">ضمان شامل</div>
                        </div>
                    </div>

                    <!-- قائمة المشاريع -->
                    <div class="projects-section">
                        <div class="section-header">
                            <h2 class="section-title">
                                <i class="fas fa-chart-line"></i>
                                أحدث المشاريع
                            </h2>
                        </div>
                        
                        <div id="projectsList" class="loading">
                            جاري تحميل المشاريع...
                        </div>
                    </div>
                </div>

                <!-- صفحات أخرى -->
                <div id="projectsPage" class="page-content" style="display: none;">
                    <div class="projects-section">
                        <div class="section-header">
                            <h2 class="section-title">
                                <i class="fas fa-building"></i>
                                جميع المشاريع
                            </h2>
                        </div>
                        <div id="allProjectsList"></div>
                    </div>
                </div>

                <div id="completedPage" class="page-content" style="display: none;">
                    <div class="projects-section">
                        <div class="section-header">
                            <h2 class="section-title">
                                <i class="fas fa-check-circle"></i>
                                المشاريع المكتملة
                            </h2>
                        </div>
                        <div class="no-results">لا توجد مشاريع مكتملة حالياً</div>
                    </div>
                </div>

                <div id="warrantyPage" class="page-content" style="display: none;">
                    <div class="projects-section">
                        <div class="section-header">
                            <h2 class="section-title">
                                <i class="fas fa-shield-alt"></i>
                                المشاريع تحت الضمان
                            </h2>
                        </div>
                        <div class="no-results">لا توجد مشاريع تحت الضمان حالياً</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- نافذة تفاصيل المشروع -->
    <div id="projectModal" class="project-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="modalProjectTitle">تفاصيل المشروع</h3>
                <button class="close-btn" onclick="closeProjectModal()">&times;</button>
            </div>
            <div class="modal-body" id="modalProjectDetails">
                <!-- سيتم ملء التفاصيل هنا بواسطة JavaScript -->
            </div>
        </div>
    </div>

    <script>
        // بيانات المشاريع الكاملة
        const projectsData = [
            {
                "id": 1,
                "projectNumber": "PRJ-2025-001",
                "projectName": "هدم واعادة بناء م س 753 مسجد وبيت امام تصميم خاص",
                "fundingEntity": "متبرع",
                "fundingSource": "الشيخ / فيصل بن قاسم آل ثاني",
                "contractNumber": "ديوان العمارة 127/12/127/2017",
                "projectCode": "تحت اشراف مكتب استشاري",
                "regionName": "عنيزه",
                "landNumber": "م س 753",
                "contractor": "درواند للتجارة والمقاولات",
                "contractValue": 35000000.0,
                "startDate": "2019-01-06",
                "endDate": "2020-06-28",
                "adjustedEndDate": "2021-09-30",
                "currentProgress": 99.0,
                "status": "active",
                "projectManager": "لايوجد",
                "consultantName": "م.ياسر عبد المولى",
                "projectUpdates": "9",
                "notes": "تم استخراج شهادة إتمام البناء للمشروع عن طريق مكتب استشاري خارجي من قبل المتبرع وجارى اجراءات تسليم مستندات المشروع للترقيم رسميا",
                "architecturalEngineer": "غير محدد",
                "mechanicalEngineer": "م.ياسر عبد المولى",
                "electricalEngineer": "م.أحمد مرسي",
                "civilEngineer": "م.يسري"
            },
            {
                "id": 2,
                "projectNumber": "PRJ-2025-002",
                "projectName": "مسجد نموذج خاص",
                "fundingEntity": "متبرع",
                "fundingSource": "غانم سلطان الهدبفي",
                "contractNumber": "----",
                "projectCode": "------",
                "regionName": "روضة اقديم",
                "landNumber": "أ د 1141",
                "contractor": "المساكن للتجارة والمقاولات",
                "contractValue": 4200000.0,
                "startDate": "2016-04-01",
                "endDate": "2019-02-28",
                "adjustedEndDate": "2019-02-28",
                "currentProgress": 99.0,
                "status": "active",
                "projectManager": "لايوجد",
                "consultantName": "م/عبدالعظيم",
                "projectUpdates": "10",
                "notes": "حسب اخر افادة من مهندس الاستشاري بأن الأمور المعلقة بسبب وفاه المتبرع رحمه الله ومتعلق الأمر بسبب الورثة",
                "architecturalEngineer": "غير محدد",
                "mechanicalEngineer": "م/عبدالعظيم",
                "electricalEngineer": "م.عبد الرحمن الموافي",
                "civilEngineer": "م. حزام"
            }
            // سيتم إضافة باقي المشاريع...
        ];

        // متغيرات عامة
        let currentUser = null;
        let filteredProjects = [...projectsData];

        // تسجيل الدخول
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            // التحقق من بيانات الدخول
            if (email === 'alzooool33@gmail.com' && password === '123456') {
                currentUser = {
                    name: 'محمد عبدالرحيم نور',
                    email: email
                };
                
                // إخفاء صفحة تسجيل الدخول وإظهار الواجهة الرئيسية
                document.getElementById('loginPage').style.display = 'none';
                document.getElementById('mainApp').style.display = 'block';
                
                // تحميل البيانات
                loadDashboard();
            } else {
                alert('بيانات الدخول غير صحيحة');
            }
        });

        // تسجيل الخروج
        function logout() {
            currentUser = null;
            document.getElementById('loginPage').style.display = 'flex';
            document.getElementById('mainApp').style.display = 'none';
            
            // إعادة تعيين النموذج
            document.getElementById('loginForm').reset();
            document.getElementById('email').value = 'alzooool33@gmail.com';
            document.getElementById('password').value = '123456';
        }

        // تحميل لوحة التحكم
        function loadDashboard() {
            // تحديث الإحصائيات
            updateStatistics();
            
            // تحميل قائمة المشاريع
            loadProjectsList();
        }

        // تحديث الإحصائيات
        function updateStatistics() {
            const totalProjects = projectsData.length;
            const activeProjects = projectsData.filter(p => p.status === 'active').length;
            const completedProjects = projectsData.filter(p => p.status === 'completed').length;
            const warrantyProjects = projectsData.filter(p => p.status === 'warranty').length;
            
            document.getElementById('totalProjects').textContent = totalProjects;
            document.getElementById('activeProjects').textContent = activeProjects;
            document.getElementById('completedProjects').textContent = completedProjects;
            document.getElementById('warrantyProjects').textContent = warrantyProjects;
        }

        // تحميل قائمة المشاريع
        function loadProjectsList() {
            const container = document.getElementById('projectsList');
            
            if (filteredProjects.length === 0) {
                container.innerHTML = '<div class="no-results">لا توجد مشاريع تطابق البحث</div>';
                return;
            }
            
            const projectsHTML = filteredProjects.map(project => `
                <div class="project-item fade-in" onclick="showProjectDetails(${project.id})">
                    <div class="project-header">
                        <div>
                            <div class="project-title">${project.projectName}</div>
                            <div class="project-number">${project.projectNumber}</div>
                        </div>
                        <div class="project-progress">
                            <div class="progress-text">نسبة الإنجاز: ${project.currentProgress}%</div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${project.currentProgress}%"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="project-details">
                        <div class="detail-item">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>المنطقة:</span>
                            <span class="detail-value">${project.regionName}</span>
                        </div>
                        <div class="detail-item">
                            <i class="fas fa-map"></i>
                            <span>رقم الأرض:</span>
                            <span class="detail-value">${project.landNumber}</span>
                        </div>
                        <div class="detail-item">
                            <i class="fas fa-hand-holding-usd"></i>
                            <span>المتبرع:</span>
                            <span class="detail-value">${project.fundingSource}</span>
                        </div>
                        <div class="detail-item">
                            <i class="fas fa-hard-hat"></i>
                            <span>المقاول:</span>
                            <span class="detail-value">${project.contractor}</span>
                        </div>
                        <div class="detail-item">
                            <i class="fas fa-dollar-sign"></i>
                            <span>قيمة العقد:</span>
                            <span class="detail-value">${formatCurrency(project.contractValue)} ريال</span>
                        </div>
                        <div class="detail-item">
                            <i class="fas fa-calendar"></i>
                            <span>تاريخ البدء:</span>
                            <span class="detail-value">${formatDate(project.startDate)}</span>
                        </div>
                    </div>
                </div>
            `).join('');
            
            container.innerHTML = projectsHTML;
        }

        // عرض تفاصيل المشروع
        function showProjectDetails(projectId) {
            const project = projectsData.find(p => p.id === projectId);
            if (!project) return;
            
            document.getElementById('modalProjectTitle').textContent = project.projectName;
            
            const detailsHTML = `
                <div class="info-grid">
                    <!-- معلومات المشروع -->
                    <div class="info-section">
                        <div class="info-section-title">
                            <i class="fas fa-info-circle"></i>
                            معلومات المشروع
                        </div>
                        <div class="info-item">
                            <span class="info-label">اسم المشروع</span>
                            <span class="info-value">${project.projectName}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">رقم المشروع</span>
                            <span class="info-value">${project.projectNumber}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">رمز المشروع</span>
                            <span class="info-value">${project.projectCode}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">رقم الأرض</span>
                            <span class="info-value">${project.landNumber}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">المنطقة</span>
                            <span class="info-value">${project.regionName}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">المقاول</span>
                            <span class="info-value">${project.contractor}</span>
                        </div>
                    </div>

                    <!-- التمويل والتقدم -->
                    <div class="info-section">
                        <div class="info-section-title">
                            <i class="fas fa-dollar-sign"></i>
                            التمويل والتقدم
                        </div>
                        <div class="info-item">
                            <span class="info-label">الممول (جهة التمويل)</span>
                            <span class="info-value">${project.fundingEntity}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">المتبرع (مصدر التمويل)</span>
                            <span class="info-value">${project.fundingSource}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">رقم العقد</span>
                            <span class="info-value">${project.contractNumber}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">قيمة العقد</span>
                            <span class="info-value">${formatCurrency(project.contractValue)} ريال</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">عدد الدفعات المنصرفة</span>
                            <span class="info-value">${project.projectUpdates} دفعة</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">نسبة الإنجاز</span>
                            <span class="info-value">${project.currentProgress}%</span>
                        </div>
                    </div>

                    <!-- التواريخ المهمة -->
                    <div class="info-section">
                        <div class="info-section-title">
                            <i class="fas fa-calendar-alt"></i>
                            التواريخ المهمة
                        </div>
                        <div class="info-item">
                            <span class="info-label">تاريخ البدء</span>
                            <span class="info-value">${formatDate(project.startDate)}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">تاريخ النهاية الأولى</span>
                            <span class="info-value">${formatDate(project.endDate)}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">تاريخ النهاية المعدل</span>
                            <span class="info-value">${formatDate(project.adjustedEndDate)}</span>
                        </div>
                    </div>

                    <!-- فريق المشروع -->
                    <div class="info-section">
                        <div class="info-section-title">
                            <i class="fas fa-users"></i>
                            فريق المشروع
                        </div>
                        <div class="info-item">
                            <span class="info-label">مدير المشروع</span>
                            <span class="info-value">${project.projectManager}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">اسم الاستشاري</span>
                            <span class="info-value">${project.consultantName}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">المهندس المعماري</span>
                            <span class="info-value">${project.architecturalEngineer}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">المهندس الميكانيكي</span>
                            <span class="info-value">${project.mechanicalEngineer}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">المهندس الكهربائي</span>
                            <span class="info-value">${project.electricalEngineer}</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">المهندس المدني</span>
                            <span class="info-value">${project.civilEngineer}</span>
                        </div>
                    </div>

                    <!-- الملاحظات -->
                    ${project.notes ? `
                    <div class="notes-section">
                        <div class="notes-title">
                            <i class="fas fa-sticky-note"></i>
                            مستجدات وملاحظات المشروع
                        </div>
                        <div class="notes-text">${project.notes}</div>
                    </div>
                    ` : ''}
                </div>
            `;
            
            document.getElementById('modalProjectDetails').innerHTML = detailsHTML;
            document.getElementById('projectModal').style.display = 'block';
        }

        // إغلاق نافذة تفاصيل المشروع
        function closeProjectModal() {
            document.getElementById('projectModal').style.display = 'none';
        }

        // البحث في المشاريع
        document.getElementById('searchInput').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase().trim();
            
            if (searchTerm === '') {
                filteredProjects = [...projectsData];
            } else {
                filteredProjects = projectsData.filter(project => 
                    project.projectName.toLowerCase().includes(searchTerm) ||
                    project.projectNumber.toLowerCase().includes(searchTerm) ||
                    project.regionName.toLowerCase().includes(searchTerm) ||
                    project.contractor.toLowerCase().includes(searchTerm) ||
                    project.fundingSource.toLowerCase().includes(searchTerm)
                );
            }
            
            loadProjectsList();
            
            // تمييز النتائج
            if (searchTerm !== '') {
                setTimeout(() => {
                    document.querySelectorAll('.project-item').forEach(item => {
                        if (item.textContent.toLowerCase().includes(searchTerm)) {
                            item.classList.add('highlight');
                        }
                    });
                }, 100);
            }
        });

        // التنقل بين الصفحات
        document.querySelectorAll('.menu-item').forEach(item => {
            item.addEventListener('click', function(e) {
                e.preventDefault();
                
                // إزالة الفئة النشطة من جميع العناصر
                document.querySelectorAll('.menu-item').forEach(i => i.classList.remove('active'));
                
                // إضافة الفئة النشطة للعنصر المحدد
                this.classList.add('active');
                
                // إخفاء جميع الصفحات
                document.querySelectorAll('.page-content').forEach(page => page.style.display = 'none');
                
                // إظهار الصفحة المحددة
                const pageId = this.getAttribute('data-page') + 'Page';
                const targetPage = document.getElementById(pageId);
                if (targetPage) {
                    targetPage.style.display = 'block';
                    
                    // تحميل البيانات حسب الصفحة
                    if (pageId === 'projectsPage') {
                        document.getElementById('allProjectsList').innerHTML = document.getElementById('projectsList').innerHTML;
                    }
                }
            });
        });

        // تبديل الشريط الجانبي للجوال
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('open');
        }

        // إغلاق النافذة المنبثقة عند النقر خارجها
        document.getElementById('projectModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeProjectModal();
            }
        });

        // دوال مساعدة
        function formatCurrency(amount) {
            return new Intl.NumberFormat('ar-SA').format(amount);
        }

        function formatDate(dateString) {
            if (!dateString) return 'غير محدد';
            const date = new Date(dateString);
            return date.toLocaleDateString('ar-SA');
        }

        // تحميل البيانات عند بدء التطبيق
        document.addEventListener('DOMContentLoaded', function() {
            // التحقق من حالة تسجيل الدخول
            if (currentUser) {
                loadDashboard();
            }
        });
    </script>
</body>
</html>

